2024-04-12 08:14:00,608 - root - INFO - Min time is 1464710400, Train time is 10, Val time is 13, Test time is 16, Time unit is 3600
2024-04-12 08:14:55,489 - root - INFO - Total Trans num is 1572287, Train cas num is 27353, Val cas num is 5861, Test cas num is 5862
2024-04-12 08:14:55,634 - root - INFO - Time cost for loading data is 73.24228763580322s
2024-04-12 08:14:55,637 - root - INFO - {'dataset': 'weibo', 'bs': 50, 'prefix': 'std_weibo_CTCP', 'epoch': 150, 'lr': 0.0001, 'run': 1, 'gpu': 0, 'node_dim': 64, 'time_dim': 16, 'patience': 15, 'dropout': 0.6, 'predictor': 'merge', 'embedding_module': 'aggregate', 'single': False, 'use_static': True, 'use_dynamic': True, 'use_structural': True, 'use_temporal': True, 'lambda': 0.1, 'model_path': 'saved_models/std_weibo_CTCP', 'result_path': 'results/std_weibo_CTCP', 'log_path': 'log/std_weibo_CTCP.log', 'observe_time': 1, 'predict_time': 500, 'time_unit': 3600, 'train_time': 10, 'val_time': 13, 'test_time': 16, 'min_cas_size': 11, 'max_cas_size': 100, 'max_time': {'user': 1, 'cas': 1}, 'node_num': {'user': 918852, 'cas': 39076}, 'max_global_time': 18.99888888888889}
2024-04-12 08:14:55,679 - root - INFO - begin runs:0
2024-04-12 08:15:01,626 - root - INFO - Start training citation
2024-04-12 08:15:01,628 - root - INFO - Epoch 0:
2024-04-12 09:20:15,775 - root - INFO - Epoch0: time_cost:2248.7593173980713 train_loss:3.601206235760278
2024-04-12 09:20:15,776 - root - INFO - train: loss:2.9728	msle:2.9182	male:1.2286	mape:0.2988	pcc:0.7317
2024-04-12 09:20:15,776 - root - INFO - val: loss:2.9642	msle:2.9519	male:1.2356	mape:0.2972	pcc:0.7319
2024-04-12 09:20:15,776 - root - INFO - test: loss:2.9011	msle:2.8614	male:1.2241	mape:0.3004	pcc:0.7400
2024-04-12 09:20:23,634 - root - INFO - Epoch 1:
2024-04-12 10:24:15,069 - root - INFO - Epoch1: time_cost:2230.971754550934 train_loss:2.8981000818268945
2024-04-12 10:24:15,069 - root - INFO - train: loss:2.8213	msle:2.7791	male:1.1939	mape:0.2928	pcc:0.7490
2024-04-12 10:24:15,069 - root - INFO - val: loss:2.8552	msle:2.8466	male:1.2070	mape:0.2937	pcc:0.7451
2024-04-12 10:24:15,069 - root - INFO - test: loss:2.8490	msle:2.8088	male:1.2094	mape:0.3001	pcc:0.7484
2024-04-12 10:24:22,254 - root - INFO - Epoch 2:
2024-04-12 11:28:56,180 - root - INFO - Epoch2: time_cost:2265.17520570755 train_loss:2.7557482748161974
2024-04-12 11:28:56,180 - root - INFO - train: loss:2.6908	msle:2.6571	male:1.1669	mape:0.2860	pcc:0.7631
2024-04-12 11:28:56,180 - root - INFO - val: loss:2.7968	msle:2.7893	male:1.1924	mape:0.2911	pcc:0.7520
2024-04-12 11:28:56,181 - root - INFO - test: loss:2.7947	msle:2.7534	male:1.1990	mape:0.2980	pcc:0.7552
2024-04-12 11:29:03,213 - root - INFO - Epoch 3:
2024-04-12 12:33:33,298 - root - INFO - Epoch3: time_cost:2266.7254621982574 train_loss:2.635365949234031
2024-04-12 12:33:33,299 - root - INFO - train: loss:2.5387	msle:2.5127	male:1.1219	mape:0.2702	pcc:0.7765
2024-04-12 12:33:33,299 - root - INFO - val: loss:2.7350	msle:2.7294	male:1.1669	mape:0.2814	pcc:0.7567
2024-04-12 12:33:33,299 - root - INFO - test: loss:2.7008	msle:2.6586	male:1.1699	mape:0.2865	pcc:0.7632
2024-04-12 12:33:41,197 - root - INFO - Epoch 4:
2024-04-12 13:38:14,562 - root - INFO - Epoch4: time_cost:2268.401885986328 train_loss:2.533593613507066
2024-04-12 13:38:14,562 - root - INFO - train: loss:2.4392	msle:2.4196	male:1.0947	mape:0.2621	pcc:0.7873
2024-04-12 13:38:14,562 - root - INFO - val: loss:2.7467	msle:2.7406	male:1.1741	mape:0.2816	pcc:0.7555
2024-04-12 13:38:14,562 - root - INFO - test: loss:2.6972	msle:2.6530	male:1.1701	mape:0.2854	pcc:0.7637
2024-04-12 13:38:19,251 - root - INFO - Epoch 5:
2024-04-12 14:42:07,897 - root - INFO - Epoch5: time_cost:2237.470039367676 train_loss:2.423246013488328
2024-04-12 14:42:07,897 - root - INFO - train: loss:2.2401	msle:2.2273	male:1.0364	mape:0.2461	pcc:0.8067
2024-04-12 14:42:07,897 - root - INFO - val: loss:2.7083	msle:2.7002	male:1.1601	mape:0.2770	pcc:0.7595
2024-04-12 14:42:07,897 - root - INFO - test: loss:2.6440	msle:2.6047	male:1.1597	mape:0.2817	pcc:0.7689
2024-04-12 14:42:14,771 - root - INFO - Epoch 6:
2024-04-12 15:45:30,135 - root - INFO - Epoch6: time_cost:2235.937707424164 train_loss:2.2796958409537127
2024-04-12 15:45:30,135 - root - INFO - train: loss:1.9994	msle:1.9940	male:0.9525	mape:0.2236	pcc:0.8288
2024-04-12 15:45:30,135 - root - INFO - val: loss:2.6902	msle:2.6811	male:1.1495	mape:0.2715	pcc:0.7600
2024-04-12 15:45:30,135 - root - INFO - test: loss:2.6217	msle:2.5821	male:1.1502	mape:0.2753	pcc:0.7689
2024-04-12 15:45:37,252 - root - INFO - Epoch 7:
2024-04-12 16:49:38,195 - root - INFO - Epoch7: time_cost:2264.845052957535 train_loss:2.137690355947493
2024-04-12 16:49:38,195 - root - INFO - train: loss:1.7652	msle:1.7702	male:0.8922	mape:0.2089	pcc:0.8501
2024-04-12 16:49:38,195 - root - INFO - val: loss:2.6791	msle:2.6713	male:1.1537	mape:0.2732	pcc:0.7615
2024-04-12 16:49:38,195 - root - INFO - test: loss:2.6138	msle:2.5703	male:1.1553	mape:0.2767	pcc:0.7707
2024-04-12 16:49:45,130 - root - INFO - Epoch 8:
2024-04-12 17:53:28,643 - root - INFO - Epoch8: time_cost:2254.1320044994354 train_loss:1.9652438122225846
2024-04-12 17:53:28,643 - root - INFO - train: loss:1.5180	msle:1.5251	male:0.8133	mape:0.1866	pcc:0.8722
2024-04-12 17:53:28,643 - root - INFO - val: loss:2.7240	msle:2.7174	male:1.1591	mape:0.2709	pcc:0.7559
2024-04-12 17:53:28,643 - root - INFO - test: loss:2.6599	msle:2.6156	male:1.1650	mape:0.2764	pcc:0.7648
2024-04-12 17:53:33,079 - root - INFO - Epoch 9:
2024-04-12 18:56:45,641 - root - INFO - Epoch9: time_cost:2231.409462451935 train_loss:1.8134091584201757
2024-04-12 18:56:45,641 - root - INFO - train: loss:1.3769	msle:1.3833	male:0.7579	mape:0.1659	pcc:0.8842
2024-04-12 18:56:45,641 - root - INFO - val: loss:2.6998	msle:2.6898	male:1.1481	mape:0.2593	pcc:0.7599
2024-04-12 18:56:45,641 - root - INFO - test: loss:2.6395	msle:2.5926	male:1.1491	mape:0.2617	pcc:0.7666
2024-04-12 18:56:50,098 - root - INFO - Epoch 10:
2024-04-12 19:59:28,153 - root - INFO - Epoch10: time_cost:2166.1629688739777 train_loss:1.6687876522694254
2024-04-12 19:59:28,153 - root - INFO - train: loss:1.2573	msle:1.2655	male:0.7242	mape:0.1577	pcc:0.8944
2024-04-12 19:59:28,154 - root - INFO - val: loss:2.7046	msle:2.6923	male:1.1491	mape:0.2604	pcc:0.7595
2024-04-12 19:59:28,154 - root - INFO - test: loss:2.6332	msle:2.5897	male:1.1472	mape:0.2627	pcc:0.7670
2024-04-12 19:59:32,700 - root - INFO - Epoch 11:
2024-04-12 21:02:52,571 - root - INFO - Epoch11: time_cost:2245.8252029418945 train_loss:1.5179781813218574
2024-04-12 21:02:52,572 - root - INFO - train: loss:1.0903	msle:1.1005	male:0.6852	mape:0.1524	pcc:0.9091
2024-04-12 21:02:52,572 - root - INFO - val: loss:2.7237	msle:2.7115	male:1.1572	mape:0.2674	pcc:0.7575
2024-04-12 21:02:52,572 - root - INFO - test: loss:2.6512	msle:2.6075	male:1.1570	mape:0.2713	pcc:0.7663
2024-04-12 21:02:57,019 - root - INFO - Epoch 12:
2024-04-12 22:06:09,217 - root - INFO - Epoch12: time_cost:2235.3397719860077 train_loss:1.4096968455568313
2024-04-12 22:06:09,217 - root - INFO - train: loss:0.9743	msle:0.9839	male:0.6441	mape:0.1381	pcc:0.9184
2024-04-12 22:06:09,217 - root - INFO - val: loss:2.7304	msle:2.7157	male:1.1598	mape:0.2634	pcc:0.7587
2024-04-12 22:06:09,217 - root - INFO - test: loss:2.6898	msle:2.6383	male:1.1577	mape:0.2654	pcc:0.7637
2024-04-12 22:06:13,703 - root - INFO - Epoch 13:
2024-04-12 23:09:27,187 - root - INFO - Epoch13: time_cost:2213.1985030174255 train_loss:1.3034964410214258
2024-04-12 23:09:27,187 - root - INFO - train: loss:0.8671	msle:0.8761	male:0.6075	mape:0.1304	pcc:0.9281
2024-04-12 23:09:27,187 - root - INFO - val: loss:2.7138	msle:2.6969	male:1.1560	mape:0.2651	pcc:0.7597
2024-04-12 23:09:27,187 - root - INFO - test: loss:2.6296	msle:2.5818	male:1.1489	mape:0.2656	pcc:0.7692
2024-04-12 23:09:31,671 - root - INFO - Epoch 14:
2024-04-13 00:12:22,619 - root - INFO - Epoch14: time_cost:2214.2744534015656 train_loss:1.187544637899659
2024-04-13 00:12:22,619 - root - INFO - train: loss:0.7792	msle:0.7897	male:0.5858	mape:0.1280	pcc:0.9354
2024-04-13 00:12:22,619 - root - INFO - val: loss:2.7652	msle:2.7568	male:1.1676	mape:0.2725	pcc:0.7561
2024-04-13 00:12:22,619 - root - INFO - test: loss:2.6640	msle:2.6124	male:1.1566	mape:0.2723	pcc:0.7690
2024-04-13 00:12:27,067 - root - INFO - Epoch 15:
2024-04-13 01:15:55,010 - root - INFO - Epoch15: time_cost:2239.8091843128204 train_loss:1.1082138802750887
2024-04-13 01:15:55,011 - root - INFO - train: loss:0.7354	msle:0.7442	male:0.5748	mape:0.1216	pcc:0.9386
2024-04-13 01:15:55,011 - root - INFO - val: loss:2.8093	msle:2.7924	male:1.1747	mape:0.2683	pcc:0.7543
2024-04-13 01:15:55,011 - root - INFO - test: loss:2.7141	msle:2.6704	male:1.1713	mape:0.2696	pcc:0.7645
2024-04-13 01:15:59,523 - root - INFO - Epoch 16:
2024-04-13 02:18:56,296 - root - INFO - Epoch16: time_cost:2221.259920835495 train_loss:1.0202203899036408
2024-04-13 02:18:56,296 - root - INFO - train: loss:0.6873	msle:0.7020	male:0.5680	mape:0.1215	pcc:0.9433
2024-04-13 02:18:56,296 - root - INFO - val: loss:2.8609	msle:2.8483	male:1.1924	mape:0.2765	pcc:0.7504
2024-04-13 02:18:56,296 - root - INFO - test: loss:2.7353	msle:2.6895	male:1.1774	mape:0.2760	pcc:0.7648
2024-04-13 02:19:00,727 - root - INFO - Epoch 17:
2024-04-13 03:22:03,369 - root - INFO - Epoch17: time_cost:2217.69504737854 train_loss:0.966025502566596
2024-04-13 03:22:03,369 - root - INFO - train: loss:0.6524	msle:0.6599	male:0.5337	mape:0.1125	pcc:0.9457
2024-04-13 03:22:03,369 - root - INFO - val: loss:2.8548	msle:2.8330	male:1.1726	mape:0.2676	pcc:0.7483
2024-04-13 03:22:03,369 - root - INFO - test: loss:2.7382	msle:2.6983	male:1.1687	mape:0.2686	pcc:0.7598
2024-04-13 03:22:07,895 - root - INFO - Epoch 18:
2024-04-13 04:25:40,647 - root - INFO - Epoch18: time_cost:2240.072862148285 train_loss:0.8648236432893542
2024-04-13 04:25:40,647 - root - INFO - train: loss:0.6171	msle:0.6233	male:0.5192	mape:0.1065	pcc:0.9497
2024-04-13 04:25:40,647 - root - INFO - val: loss:2.8023	msle:2.7831	male:1.1603	mape:0.2598	pcc:0.7539
2024-04-13 04:25:40,647 - root - INFO - test: loss:2.7352	msle:2.6884	male:1.1573	mape:0.2613	pcc:0.7606
2024-04-13 04:25:45,060 - root - INFO - Epoch 19:
2024-04-13 05:29:04,398 - root - INFO - Epoch19: time_cost:2232.924057006836 train_loss:0.7925062745981987
2024-04-13 05:29:04,398 - root - INFO - train: loss:0.5923	msle:0.5962	male:0.5132	mape:0.1055	pcc:0.9513
2024-04-13 05:29:04,398 - root - INFO - val: loss:2.8656	msle:2.8475	male:1.1764	mape:0.2640	pcc:0.7481
2024-04-13 05:29:04,398 - root - INFO - test: loss:2.7675	msle:2.7228	male:1.1694	mape:0.2648	pcc:0.7581
2024-04-13 05:29:08,891 - root - INFO - Epoch 20:
2024-04-13 06:32:19,803 - root - INFO - Epoch20: time_cost:2234.971100091934 train_loss:0.7468742882387011
2024-04-13 06:32:19,803 - root - INFO - train: loss:0.5229	msle:0.5305	male:0.4990	mape:0.1036	pcc:0.9576
2024-04-13 06:32:19,803 - root - INFO - val: loss:2.8198	msle:2.8063	male:1.1720	mape:0.2708	pcc:0.7539
2024-04-13 06:32:19,803 - root - INFO - test: loss:2.7734	msle:2.7293	male:1.1793	mape:0.2757	pcc:0.7604
2024-04-13 06:32:24,272 - root - INFO - Epoch 21:
2024-04-13 07:35:27,641 - root - INFO - Epoch21: time_cost:2220.9636101722717 train_loss:0.7150695081660939
2024-04-13 07:35:27,642 - root - INFO - train: loss:0.4976	msle:0.5028	male:0.4706	mape:0.0957	pcc:0.9605
2024-04-13 07:35:27,642 - root - INFO - val: loss:2.8510	msle:2.8303	male:1.1653	mape:0.2615	pcc:0.7509
2024-04-13 07:35:27,642 - root - INFO - test: loss:2.7286	msle:2.6818	male:1.1543	mape:0.2600	pcc:0.7621
2024-04-13 07:35:32,068 - root - INFO - Epoch 22:
2024-04-13 08:38:53,441 - root - INFO - Epoch22: time_cost:2224.8412759304047 train_loss:0.6630247829749164
2024-04-13 08:38:53,441 - root - INFO - train: loss:0.5355	msle:0.5321	male:0.4823	mape:0.0976	pcc:0.9570
2024-04-13 08:38:53,441 - root - INFO - val: loss:2.9109	msle:2.8970	male:1.1767	mape:0.2648	pcc:0.7401
2024-04-13 08:38:53,441 - root - INFO - test: loss:2.7724	msle:2.7227	male:1.1647	mape:0.2646	pcc:0.7544
2024-04-13 08:38:58,010 - root - INFO - Epoch 23:
2024-04-13 09:42:19,870 - root - INFO - Epoch23: time_cost:2231.434196949005 train_loss:0.6454941291997022
2024-04-13 09:42:19,870 - root - INFO - train: loss:0.4695	msle:0.4739	male:0.4653	mape:0.0959	pcc:0.9615
2024-04-13 09:42:19,871 - root - INFO - val: loss:2.8326	msle:2.8173	male:1.1635	mape:0.2690	pcc:0.7500
2024-04-13 09:42:19,871 - root - INFO - test: loss:2.8212	msle:2.7627	male:1.1694	mape:0.2729	pcc:0.7534
2024-04-13 09:42:19,871 - root - INFO - No improvement over 15 epochs, stop training
2024-04-13 09:42:19,871 - root - INFO - Loading the best model at epoch 7
2024-04-13 09:42:20,846 - root - INFO - Loaded the best model at epoch 7 for inference
2024-04-13 10:08:30,021 - root - INFO - Runs:0
 {'train': {'msle': [2.9182, 2.7791, 2.6571, 2.5127, 2.4196, 2.2273, 1.994, 1.7702, 1.5251, 1.3833, 1.2655, 1.1005, 0.9839, 0.8761, 0.7897, 0.7442, 0.702, 0.6599, 0.6233, 0.5962, 0.5305, 0.5028, 0.5321, 0.4739, 1.7702], 'male': [1.2286, 1.1939, 1.1669, 1.1219, 1.0947, 1.0364, 0.9525, 0.8922, 0.8133, 0.7579, 0.7242, 0.6852, 0.6441, 0.6075, 0.5858, 0.5748, 0.568, 0.5337, 0.5192, 0.5132, 0.499, 0.4706, 0.4823, 0.4653, 0.8922], 'mape': [0.2988, 0.2928, 0.286, 0.2702, 0.2621, 0.2461, 0.2236, 0.2089, 0.1866, 0.1659, 0.1577, 0.1524, 0.1381, 0.1304, 0.128, 0.1216, 0.1215, 0.1125, 0.1065, 0.1055, 0.1036, 0.0957, 0.0976, 0.0959, 0.2089], 'pcc': [0.7317, 0.749, 0.7631, 0.7765, 0.7873, 0.8067, 0.8288, 0.8501, 0.8722, 0.8842, 0.8944, 0.9091, 0.9184, 0.9281, 0.9354, 0.9386, 0.9433, 0.9457, 0.9497, 0.9513, 0.9576, 0.9605, 0.957, 0.9615, 0.8501], 'loss': [2.9728202333904834, 2.8212538826427864, 2.6907634523311783, 2.538665388590407, 2.439230834443294, 2.240121768856605, 1.9993774815207714, 1.7652445546103224, 1.5179669918020122, 1.3769496954670577, 1.2572877347765452, 1.0903451498604482, 0.9743479343409444, 0.8671338392969993, 0.7791699737999164, 0.7353656589101358, 0.6873460589119774, 0.6523796115497363, 0.6171150990691696, 0.5922577150197552, 0.5228613500974602, 0.4975728143682148, 0.5355348995305168, 0.4694943499032073, 1.7652445546103224]}, 'val': {'msle': [2.9519, 2.8466, 2.7893, 2.7294, 2.7406, 2.7002, 2.6811, 2.6713, 2.7174, 2.6898, 2.6923, 2.7115, 2.7157, 2.6969, 2.7568, 2.7924, 2.8483, 2.833, 2.7831, 2.8475, 2.8063, 2.8303, 2.897, 2.8173, 2.6713], 'male': [1.2356, 1.207, 1.1924, 1.1669, 1.1741, 1.1601, 1.1495, 1.1537, 1.1591, 1.1481, 1.1491, 1.1572, 1.1598, 1.156, 1.1676, 1.1747, 1.1924, 1.1726, 1.1603, 1.1764, 1.172, 1.1653, 1.1767, 1.1635, 1.1537], 'mape': [0.2972, 0.2937, 0.2911, 0.2814, 0.2816, 0.277, 0.2715, 0.2732, 0.2709, 0.2593, 0.2604, 0.2674, 0.2634, 0.2651, 0.2725, 0.2683, 0.2765, 0.2676, 0.2598, 0.264, 0.2708, 0.2615, 0.2648, 0.269, 0.2732], 'pcc': [0.7319, 0.7451, 0.752, 0.7567, 0.7555, 0.7595, 0.76, 0.7615, 0.7559, 0.7599, 0.7595, 0.7575, 0.7587, 0.7597, 0.7561, 0.7543, 0.7504, 0.7483, 0.7539, 0.7481, 0.7539, 0.7509, 0.7401, 0.75, 0.7615], 'loss': [2.964154243807332, 2.855215837772401, 2.7968454853295404, 2.735006054603604, 2.746652392976485, 2.708306019484513, 2.6901655453235653, 2.6791013058780204, 2.7239656939741805, 2.699833836705474, 2.704575473510713, 2.7237047316590077, 2.7304059759149726, 2.713750413015388, 2.765201281613004, 2.8093348387276578, 2.860869991781971, 2.854808354446382, 2.802250980778398, 2.8656081166642937, 2.8198039278486733, 2.8509927551182765, 2.9109299923226524, 2.832588101365377, 2.6791013058780204]}, 'test': {'msle': [2.8614, 2.8088, 2.7534, 2.6586, 2.653, 2.6047, 2.5821, 2.5703, 2.6156, 2.5926, 2.5897, 2.6075, 2.6383, 2.5818, 2.6124, 2.6704, 2.6895, 2.6983, 2.6884, 2.7228, 2.7293, 2.6818, 2.7227, 2.7627, 2.5703], 'male': [1.2241, 1.2094, 1.199, 1.1699, 1.1701, 1.1597, 1.1502, 1.1553, 1.165, 1.1491, 1.1472, 1.157, 1.1577, 1.1489, 1.1566, 1.1713, 1.1774, 1.1687, 1.1573, 1.1694, 1.1793, 1.1543, 1.1647, 1.1694, 1.1553], 'mape': [0.3004, 0.3001, 0.298, 0.2865, 0.2854, 0.2817, 0.2753, 0.2767, 0.2764, 0.2617, 0.2627, 0.2713, 0.2654, 0.2656, 0.2723, 0.2696, 0.276, 0.2686, 0.2613, 0.2648, 0.2757, 0.26, 0.2646, 0.2729, 0.2767], 'pcc': [0.74, 0.7484, 0.7552, 0.7632, 0.7637, 0.7689, 0.7689, 0.7707, 0.7648, 0.7666, 0.767, 0.7663, 0.7637, 0.7692, 0.769, 0.7645, 0.7648, 0.7598, 0.7606, 0.7581, 0.7604, 0.7621, 0.7544, 0.7534, 0.7707], 'loss': [2.901097604550051, 2.8489816486130954, 2.7946965309102163, 2.700830514515322, 2.697182777726182, 2.644015856551246, 2.6216518391007337, 2.613842957032601, 2.659895807902109, 2.6394513505160915, 2.6331918927038243, 2.651206382177225, 2.689757608558262, 2.6296285396644246, 2.664022309891179, 2.714090263151908, 2.7352976736762025, 2.738225784037935, 2.735220501162484, 2.767523800803986, 2.7734128513842444, 2.72862853138929, 2.772438000908005, 2.821196918337829, 2.613842957032601]}}
2024-04-13 10:08:32,477 - root - INFO - Final: msle:2.5703 male:1.1553 mape:0.2767 pcc:0.7707
